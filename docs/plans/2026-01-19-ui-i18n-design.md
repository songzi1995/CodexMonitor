# UI I18n Design

**Goal:** Add lightweight i18n for UI strings so upstream updates only require translating new keys.

**Context:** CodexMonitor is a React + Vite frontend with no existing i18n framework. We will add a minimal, dependency free i18n layer and keep changes localized to UI text.

## Architecture

- Add a small i18n module under `src/i18n/`.
- Store translations in JSON files: `translations/en.json` and `translations/zh-CN.json`.
- Provide an `I18nProvider` (React Context) and `useI18n()` hook.
- `t(key, vars?)` resolves current locale first, then falls back to English, then to the key itself.
- Locale preference stored in `localStorage` (no backend changes).
- Default locale: `zh-CN` if `navigator.language` starts with `zh`, otherwise `en`.

## Components and Files

- `src/i18n/I18nProvider.tsx`: owns locale state and message lookup.
- `src/i18n/useI18n.ts`: exposes `t`, `locale`, and `setLocale`.
- `src/i18n/index.ts`: single entrypoint export.
- `src/i18n/translations/en.json`: base strings.
- `src/i18n/translations/zh-CN.json`: Chinese strings.
- `src/main.tsx`: wrap `App` with `I18nProvider`.
- `src/features/settings/components/SettingsView.tsx`: add language selector.

## Data Flow

1. On app start, `I18nProvider` reads `localStorage`.
2. If no stored locale, chooses based on browser language.
3. UI components call `t("settings.general.title")` etc.
4. When user changes language in Settings, `setLocale` updates context and persists preference.

## String Keys and Organization

- Keys are stable and grouped by feature: `settings.general.title`, `home.empty_state`.
- Avoid embedding dynamic values in keys; use `{{name}}` style placeholders.
- Keep keys consistent to minimize upstream merge conflicts.

## Error Handling

- Missing key: fall back to English, then return the key.
- In development mode, log missing keys with `console.warn`.

## Testing and Validation

- Manual verification: switch language and confirm key screens update.
- Ensure fallback behavior renders English for missing Chinese entries.
- Run `npm run lint` and `npm run typecheck` after changes.

## Merge Strategy

- All UI text centralized to translation JSON.
- Upstream changes typically add new English strings; only add new keys to `en.json` and `zh-CN.json`.
- Existing keys remain stable, avoiding re translation.
